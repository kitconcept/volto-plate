/*! For license information please see reactPlayerHls.0e55d665.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_plone_volto=self.webpackChunk_plone_volto||[]).push([[8892],{"../../../node_modules/.pnpm/hls-video-element@1.5.8/node_modules/hls-video-element/dist/react.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return react_react_default}});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),custom_media_element=__webpack_require__("../../../node_modules/.pnpm/custom-media-element@1.4.5/node_modules/custom-media-element/dist/custom-media-element.js"),dist=__webpack_require__("../../../node_modules/.pnpm/media-tracks@0.3.3/node_modules/media-tracks/dist/index.js"),hls=__webpack_require__("../../../node_modules/.pnpm/hls.js@1.6.13/node_modules/hls.js/dist/hls.mjs");const HlsVideoElement=(superclass=(0,dist.MJ)(custom_media_element.Ou),class HlsVideo extends superclass{static shadowRootOptions={...superclass.shadowRootOptions};static getTemplateHTML=(attrs,props={})=>{const{src:src,...rest}=attrs;return`\n        <script type="application/json" id="config">\n          ${JSON.stringify(props.config||{})}\n        <\/script>\n        ${superclass.getTemplateHTML(rest)}\n      `};#airplaySourceEl=null;#config=null;constructor(){super(),this.#upgradeProperty("config")}get config(){return this.#config}set config(value){this.#config=value}attributeChangedCallback(attrName,oldValue,newValue){"src"!==attrName&&super.attributeChangedCallback(attrName,oldValue,newValue),"src"===attrName&&oldValue!=newValue&&this.load()}#destroy(){var _a,_b;null==(_a=this.#airplaySourceEl)||_a.remove(),null==(_b=this.nativeEl)||_b.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#toggleHlsLoad),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)}async load(){var _a,_b;const isFirstLoad=!this.api;if(this.#destroy(),this.src){if(isFirstLoad&&!this.#config&&(this.#config=JSON.parse((null==(_a=this.shadowRoot.getElementById("config"))?void 0:_a.textContent)||"{}")),hls.cp.isSupported()){switch(await Promise.resolve(),this.api=new hls.cp({liveDurationInfinity:!0,autoStartLoad:!1,...this.config}),this.api.loadSource(this.src),this.api.attachMedia(this.nativeEl),this.nativeEl.preload){case"none":{const loadSourceOnPlay=()=>this.api.startLoad();this.nativeEl.addEventListener("play",loadSourceOnPlay,{once:!0}),this.api.on(hls.cp.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",loadSourceOnPlay)});break}case"metadata":{const originalLength=this.api.config.maxBufferLength,originalSize=this.api.config.maxBufferSize;this.api.config.maxBufferLength=1,this.api.config.maxBufferSize=1;const increaseBufferOnPlay=()=>{this.api.config.maxBufferLength=originalLength,this.api.config.maxBufferSize=originalSize};this.nativeEl.addEventListener("play",increaseBufferOnPlay,{once:!0}),this.api.on(hls.cp.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",increaseBufferOnPlay)}),this.api.startLoad();break}default:this.api.startLoad()}this.nativeEl.webkitCurrentPlaybackTargetIsWireless&&this.api.stopLoad(),this.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#toggleHlsLoad),this.#airplaySourceEl=document.createElement("source"),this.#airplaySourceEl.setAttribute("type","application/x-mpegURL"),this.#airplaySourceEl.setAttribute("src",this.src),this.nativeEl.disableRemotePlayback=!1,this.nativeEl.append(this.#airplaySourceEl);const levelIdMap=new WeakMap;this.api.on(hls.cp.Events.MANIFEST_PARSED,(event,data)=>{this.nativeEl.autoplay&&this.nativeEl.paused&&this.nativeEl.play().catch(err=>{console.warn("Autoplay failed:",err)}),removeAllMediaTracks();let videoTrack=this.videoTracks.getTrackById("main");videoTrack||(videoTrack=this.addVideoTrack("main"),videoTrack.id="main",videoTrack.selected=!0);for(const[id,level]of data.levels.entries()){const videoRendition=videoTrack.addRendition(level.url[0],level.width,level.height,level.videoCodec,level.bitrate);levelIdMap.set(level,`${id}`),videoRendition.id=`${id}`}for(let[id,a]of data.audioTracks.entries()){const kind=a.default?"main":"alternative",audioTrack=this.addAudioTrack(kind,a.name,a.lang);audioTrack.id=`${id}`,a.default&&(audioTrack.enabled=!0)}}),this.audioTracks.addEventListener("change",()=>{var _a2;const audioTrackId=+(null==(_a2=[...this.audioTracks].find(t=>t.enabled))?void 0:_a2.id),availableIds=this.api.audioTracks.map(t=>t.id);audioTrackId!=this.api.audioTrack&&availableIds.includes(audioTrackId)&&(this.api.audioTrack=audioTrackId)}),this.api.on(hls.cp.Events.LEVELS_UPDATED,(event,data)=>{const videoTrack=this.videoTracks[this.videoTracks.selectedIndex??0];if(!videoTrack)return;const levelIds=data.levels.map(l=>levelIdMap.get(l));for(const rendition of this.videoRenditions)rendition.id&&!levelIds.includes(rendition.id)&&videoTrack.removeRendition(rendition)});const switchRendition=event=>{const level=event.target.selectedIndex;level!=this.api.nextLevel&&(this.api.nextLevel=level)};null==(_b=this.videoRenditions)||_b.addEventListener("change",switchRendition);const removeAllMediaTracks=()=>{for(const videoTrack of this.videoTracks)this.removeVideoTrack(videoTrack);for(const audioTrack of this.audioTracks)this.removeAudioTrack(audioTrack)};return void this.api.once(hls.cp.Events.DESTROYING,removeAllMediaTracks)}await Promise.resolve(),this.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(this.nativeEl.src=this.src)}}#toggleHlsLoad=()=>{var _a,_b,_c;(null==(_a=this.nativeEl)?void 0:_a.webkitCurrentPlaybackTargetIsWireless)?null==(_b=this.api)||_b.stopLoad():null==(_c=this.api)||_c.startLoad()};#upgradeProperty(prop){if(Object.prototype.hasOwnProperty.call(this,prop)){const value=this[prop];delete this[prop],this[prop]=value}}});var superclass;globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",HlsVideoElement);var hls_video_element_default=HlsVideoElement,reservedReactProps=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),reactPropToAttrNameMap={className:"class",htmlFor:"for"};function defaultToAttributeName(propName){return propName.toLowerCase()}function defaultToAttributeValue(propValue){return"boolean"==typeof propValue?propValue?"":void 0:"function"==typeof propValue||"object"==typeof propValue&&null!==propValue?void 0:propValue}function setProperty(node,name,value){var _a;node[name]=value,null==value&&name in((null==(_a=globalThis.HTMLElement)?void 0:_a.prototype)??{})&&node.removeAttribute(name)}var react_react_default=function createComponent({react:React2,tagName:tagName,elementClass:elementClass,events:events,displayName:displayName,defaultProps:defaultProps,toAttributeName:toAttributeName=defaultToAttributeName,toAttributeValue:toAttributeValue=defaultToAttributeValue}){const IS_REACT_19_OR_NEWER=Number.parseInt(React2.version)>=19,ReactComponent=React2.forwardRef((props,ref)=>{var _a,_b;const elementRef=React2.useRef(null),prevElemPropsRef=React2.useRef(new Map),eventProps={},attrs={},reactProps={},elementProps={};for(const[k,v]of Object.entries(props)){if(reservedReactProps.has(k)){reactProps[k]=v;continue}const attrName=toAttributeName(reactPropToAttrNameMap[k]??k);if(elementClass.prototype&&k in elementClass.prototype&&!(k in((null==(_a=globalThis.HTMLElement)?void 0:_a.prototype)??{}))&&!(null==(_b=elementClass.observedAttributes)?void 0:_b.some(attr=>attr===attrName))){elementProps[k]=v;continue}if(k.startsWith("on")){eventProps[k]=v;continue}const attrValue=toAttributeValue(v);if(attrName&&null!=attrValue&&(attrs[attrName]=String(attrValue),IS_REACT_19_OR_NEWER||(reactProps[attrName]=attrValue)),attrName&&IS_REACT_19_OR_NEWER){const attrValueFromDefault=defaultToAttributeValue(v);reactProps[attrName]=attrValue!==attrValueFromDefault?attrValue:v}}if("undefined"!=typeof window){for(const propName in eventProps){const callback=eventProps[propName],useCapture=propName.endsWith("Capture"),eventName=((null==events?void 0:events[propName])??propName.slice(2).toLowerCase()).slice(0,useCapture?-7:void 0);React2.useLayoutEffect(()=>{const eventTarget=null==elementRef?void 0:elementRef.current;if(eventTarget&&"function"==typeof callback)return eventTarget.addEventListener(eventName,callback,useCapture),()=>{eventTarget.removeEventListener(eventName,callback,useCapture)}},[null==elementRef?void 0:elementRef.current,callback])}React2.useLayoutEffect(()=>{if(null===elementRef.current)return;const newElemProps=new Map;for(const key in elementProps)setProperty(elementRef.current,key,elementProps[key]),prevElemPropsRef.current.delete(key),newElemProps.set(key,elementProps[key]);for(const[key,_value]of prevElemPropsRef.current)setProperty(elementRef.current,key,void 0);prevElemPropsRef.current=newElemProps})}if("undefined"==typeof window&&(null==elementClass?void 0:elementClass.getTemplateHTML)&&(null==elementClass?void 0:elementClass.shadowRootOptions)){const{mode:mode,delegatesFocus:delegatesFocus}=elementClass.shadowRootOptions,templateShadowRoot=React2.createElement("template",{shadowrootmode:mode,shadowrootdelegatesfocus:delegatesFocus,dangerouslySetInnerHTML:{__html:elementClass.getTemplateHTML(attrs,props)}});reactProps.children=[templateShadowRoot,reactProps.children]}return React2.createElement(tagName,{...defaultProps,...reactProps,ref:React2.useCallback(node=>{elementRef.current=node,"function"==typeof ref?ref(node):null!==ref&&(ref.current=node)},[ref])})});return ReactComponent.displayName=displayName??elementClass.name,ReactComponent}({react:react,tagName:"hls-video",elementClass:hls_video_element_default,toAttributeName(propName){return"muted"===propName?"":"defaultMuted"===propName?"muted":defaultToAttributeName(propName)}})}}]);