/*! For license information please see reactPlayerTwitch.1556b672.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_plone_volto=self.webpackChunk_plone_volto||[]).push([[5072],{"../../../node_modules/.pnpm/twitch-video-element@0.1.4/node_modules/twitch-video-element/dist/react.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return react_react_default}});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");const EMBED_BASE="https://player.twitch.tv",MATCH_VIDEO=/(?:www\.|go\.)?twitch\.tv\/(?:videos?\/|\?video=)(\d+)($|\?)/,MATCH_CHANNEL=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,PlaybackState_IDLE="Idle",PlaybackState_ENDED="Ended",PlayerCommands_PAUSE=2,PlayerCommands_PLAY=3,PlayerCommands_SEEK=4,PlayerCommands_SET_MUTED=10,PlayerCommands_SET_VOLUME=11;function getTemplateHTML(attrs,props={}){const iframeAttrs={src:serializeIframeUrl(attrs,props),frameborder:"0",width:"100%",height:"100%",allow:"accelerometer; fullscreen; autoplay; encrypted-media; picture-in-picture;",sandbox:"allow-modals allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox",scrolling:"no"};return props.config&&(iframeAttrs["data-config"]=JSON.stringify(props.config)),`\n    <style>\n      :host {\n        display: inline-block;\n        min-width: 300px;\n        min-height: 150px;\n        position: relative;\n      }\n      iframe {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n      :host(:not([controls])) {\n        pointer-events: none;\n      }\n    </style>\n    <iframe${function serializeAttributes(attrs){let html="";for(const key in attrs){const value=attrs[key];html+=""===value?` ${escapeHtml(key)}`:` ${escapeHtml(key)}="${escapeHtml(`${value}`)}"`}return html}(iframeAttrs)}></iframe>\n  `}function serializeIframeUrl(attrs,props){var _a;if(!attrs.src)return;const videoMatch=attrs.src.match(MATCH_VIDEO),channelMatch=attrs.src.match(MATCH_CHANNEL),params={parent:null==(_a=globalThis.location)?void 0:_a.hostname,controls:""===attrs.controls&&null,autoplay:""===attrs.autoplay&&null,muted:attrs.muted,preload:attrs.preload,...props.config};if(videoMatch){const videoId=videoMatch[1];return`${EMBED_BASE}/?video=v${videoId}&${serialize(params)}`}if(channelMatch){const channel=channelMatch[1];return`${EMBED_BASE}/?channel=${channel}&${serialize(params)}`}return""}class TwitchVideoElement extends(globalThis.HTMLElement??class{}){static getTemplateHTML=getTemplateHTML;static shadowRootOptions={mode:"open"};static observedAttributes=["autoplay","controls","loop","muted","playsinline","preload","src"];loadComplete=new PublicPromise;#loadRequested;#hasLoaded;#iframe;#playerState={};#currentTime=0;#muted=!1;#volume=1;#paused=!this.autoplay;#seeking=!1;#readyState=0;#config=null;constructor(){super(),this.#upgradeProperty("config")}get config(){return this.#config}set config(value){this.#config=value}async load(){if(this.#loadRequested)return;this.shadowRoot||this.attachShadow({mode:"open"});const isFirstLoad=!this.#hasLoaded;if(this.#hasLoaded&&(this.loadComplete=new PublicPromise),this.#hasLoaded=!0,await(this.#loadRequested=Promise.resolve()),this.#loadRequested=null,this.#readyState=0,this.dispatchEvent(new Event("emptied")),!this.src)return this.shadowRoot.innerHTML="",void globalThis.removeEventListener("message",this.#onMessage);this.dispatchEvent(new Event("loadstart"));let iframe=this.shadowRoot.querySelector("iframe");const attrs=function namedNodeMapToObject(namedNodeMap){let obj={};for(let attr of namedNodeMap)obj[attr.name]=attr.value;return obj}(this.attributes);isFirstLoad&&iframe&&(this.#config=JSON.parse(iframe.getAttribute("data-config")||"{}")),(null==iframe?void 0:iframe.src)&&iframe.src===serializeIframeUrl(attrs,this)||(this.shadowRoot.innerHTML=getTemplateHTML(attrs,this),iframe=this.shadowRoot.querySelector("iframe")),this.#iframe=iframe,globalThis.addEventListener("message",this.#onMessage)}attributeChangedCallback(attrName,oldValue,newValue){if(oldValue!==newValue)switch(attrName){case"src":case"controls":this.load()}}getVideoPlaybackQuality(){return this.#playerState.stats.videoStats}get src(){return this.getAttribute("src")}set src(value){this.setAttribute("src",value)}get readyState(){return this.#readyState}get seeking(){return this.#seeking}get buffered(){var _a,_b;return function createTimeRanges(start,end){if(Array.isArray(start))return createTimeRangesObj(start);if(null==start||null==end||0===start&&0===end)return createTimeRangesObj([[0,0]]);return createTimeRangesObj([[start,end]])}(0,(null==(_b=null==(_a=this.#playerState.stats)?void 0:_a.videoStats)?void 0:_b.bufferSize)??0)}get paused(){return this.#playerState.playback?this.#playerState.playback===PlaybackState_IDLE:this.#paused}get ended(){return!!this.#playerState.playback&&this.#playerState.playback===PlaybackState_ENDED}get duration(){return this.#playerState.duration??NaN}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(val){this.autoplay!=val&&this.toggleAttribute("autoplay",Boolean(val))}get controls(){return this.hasAttribute("controls")}set controls(val){this.controls!=val&&this.toggleAttribute("controls",Boolean(val))}get currentTime(){return this.#playerState.currentTime?this.#playerState.currentTime:this.#currentTime}set currentTime(val){this.#currentTime=val,this.loadComplete.then(()=>{this.#sendCommand(PlayerCommands_SEEK,val)})}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(val){this.toggleAttribute("muted",Boolean(val))}get loop(){return this.hasAttribute("loop")}set loop(val){this.toggleAttribute("loop",Boolean(val))}get muted(){return this.#muted}set muted(val){this.#muted=val,this.loadComplete.then(()=>{this.#sendCommand(PlayerCommands_SET_MUTED,val)})}get volume(){return this.#volume}set volume(val){this.#volume=val,this.loadComplete.then(()=>{this.#sendCommand(PlayerCommands_SET_VOLUME,val)})}get playsInline(){return this.hasAttribute("playsinline")}set playsInline(val){this.toggleAttribute("playsinline",Boolean(val))}play(){this.#paused=!1,this.#sendCommand(PlayerCommands_PLAY)}pause(){this.#paused=!0,this.#sendCommand(PlayerCommands_PAUSE)}#onMessage=async event=>{var _a,_b,_c,_d;if(!this.#iframe.contentWindow)return;const{data:data,source:source}=event;if(source===this.#iframe.contentWindow)if("twitch-embed"===data.namespace)await new Promise(resolve=>setTimeout(resolve,10)),"ready"===data.eventName?(this.dispatchEvent(new Event("loadcomplete")),this.loadComplete.resolve(),this.#readyState=1,this.dispatchEvent(new Event("loadedmetadata"))):"seek"===data.eventName?(this.#seeking=!0,this.dispatchEvent(new Event("seeking"))):"playing"===data.eventName?(this.#seeking&&(this.#seeking=!1,this.dispatchEvent(new Event("seeked"))),this.#readyState=3,this.dispatchEvent(new Event("playing"))):this.dispatchEvent(new Event(data.eventName));else if("twitch-embed-player-proxy"===data.namespace&&"UPDATE_STATE"===data.eventName){const oldDuration=this.#playerState.duration,oldCurrentTime=this.#playerState.currentTime,oldVolume=this.#playerState.volume,oldMuted=this.#playerState.muted,oldBuffered=null==(_b=null==(_a=this.#playerState.stats)?void 0:_a.videoStats)?void 0:_b.bufferSize;this.#playerState={...this.#playerState,...data.params},oldDuration!==this.#playerState.duration&&this.dispatchEvent(new Event("durationchange")),oldCurrentTime!==this.#playerState.currentTime&&this.dispatchEvent(new Event("timeupdate")),oldVolume===this.#playerState.volume&&oldMuted===this.#playerState.muted||this.dispatchEvent(new Event("volumechange")),oldBuffered!==(null==(_d=null==(_c=this.#playerState.stats)?void 0:_c.videoStats)?void 0:_d.bufferSize)&&this.dispatchEvent(new Event("progress"))}};#sendCommand(command,params){if(!this.#iframe.contentWindow)return;const message={eventName:command,params:params,namespace:"twitch-embed-player-proxy"};this.#iframe.contentWindow.postMessage(message,EMBED_BASE)}#upgradeProperty(prop){if(Object.prototype.hasOwnProperty.call(this,prop)){const value=this[prop];delete this[prop],this[prop]=value}}}function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/`/g,"&#x60;")}function serialize(props){return String(new URLSearchParams(function filterParams(props){let p={};for(let key in props){let val=props[key];!0===val||""===val?p[key]=!0:!1===val?p[key]=!1:null!=val&&(p[key]=val)}return p}(props)))}class PublicPromise extends Promise{constructor(executor=()=>{}){let res,rej;super((resolve,reject)=>{executor(resolve,reject),res=resolve,rej=reject}),this.resolve=res,this.reject=rej}}function createTimeRangesObj(ranges){return Object.defineProperties(ranges,{start:{value:i=>ranges[i][0]},end:{value:i=>ranges[i][1]}}),ranges}globalThis.customElements&&!globalThis.customElements.get("twitch-video")&&globalThis.customElements.define("twitch-video",TwitchVideoElement);var twitch_video_element_default=TwitchVideoElement,reservedReactProps=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),reactPropToAttrNameMap={className:"class",htmlFor:"for"};function defaultToAttributeName(propName){return propName.toLowerCase()}function defaultToAttributeValue(propValue){return"boolean"==typeof propValue?propValue?"":void 0:"function"==typeof propValue||"object"==typeof propValue&&null!==propValue?void 0:propValue}function setProperty(node,name,value){var _a;node[name]=value,null==value&&name in((null==(_a=globalThis.HTMLElement)?void 0:_a.prototype)??{})&&node.removeAttribute(name)}var react_react_default=function createComponent({react:React2,tagName:tagName,elementClass:elementClass,events:events,displayName:displayName,defaultProps:defaultProps,toAttributeName:toAttributeName=defaultToAttributeName,toAttributeValue:toAttributeValue=defaultToAttributeValue}){const IS_REACT_19_OR_NEWER=Number.parseInt(React2.version)>=19,ReactComponent=React2.forwardRef((props,ref)=>{var _a,_b;const elementRef=React2.useRef(null),prevElemPropsRef=React2.useRef(new Map),eventProps={},attrs={},reactProps={},elementProps={};for(const[k,v]of Object.entries(props)){if(reservedReactProps.has(k)){reactProps[k]=v;continue}const attrName=toAttributeName(reactPropToAttrNameMap[k]??k);if(elementClass.prototype&&k in elementClass.prototype&&!(k in((null==(_a=globalThis.HTMLElement)?void 0:_a.prototype)??{}))&&!(null==(_b=elementClass.observedAttributes)?void 0:_b.some(attr=>attr===attrName))){elementProps[k]=v;continue}if(k.startsWith("on")){eventProps[k]=v;continue}const attrValue=toAttributeValue(v);if(attrName&&null!=attrValue&&(attrs[attrName]=String(attrValue),IS_REACT_19_OR_NEWER||(reactProps[attrName]=attrValue)),attrName&&IS_REACT_19_OR_NEWER){const attrValueFromDefault=defaultToAttributeValue(v);reactProps[attrName]=attrValue!==attrValueFromDefault?attrValue:v}}if("undefined"!=typeof window){for(const propName in eventProps){const callback=eventProps[propName],useCapture=propName.endsWith("Capture"),eventName=((null==events?void 0:events[propName])??propName.slice(2).toLowerCase()).slice(0,useCapture?-7:void 0);React2.useLayoutEffect(()=>{const eventTarget=null==elementRef?void 0:elementRef.current;if(eventTarget&&"function"==typeof callback)return eventTarget.addEventListener(eventName,callback,useCapture),()=>{eventTarget.removeEventListener(eventName,callback,useCapture)}},[null==elementRef?void 0:elementRef.current,callback])}React2.useLayoutEffect(()=>{if(null===elementRef.current)return;const newElemProps=new Map;for(const key in elementProps)setProperty(elementRef.current,key,elementProps[key]),prevElemPropsRef.current.delete(key),newElemProps.set(key,elementProps[key]);for(const[key,_value]of prevElemPropsRef.current)setProperty(elementRef.current,key,void 0);prevElemPropsRef.current=newElemProps})}if("undefined"==typeof window&&(null==elementClass?void 0:elementClass.getTemplateHTML)&&(null==elementClass?void 0:elementClass.shadowRootOptions)){const{mode:mode,delegatesFocus:delegatesFocus}=elementClass.shadowRootOptions,templateShadowRoot=React2.createElement("template",{shadowrootmode:mode,shadowrootdelegatesfocus:delegatesFocus,dangerouslySetInnerHTML:{__html:elementClass.getTemplateHTML(attrs,props)}});reactProps.children=[templateShadowRoot,reactProps.children]}return React2.createElement(tagName,{...defaultProps,...reactProps,ref:React2.useCallback(node=>{elementRef.current=node,"function"==typeof ref?ref(node):null!==ref&&(ref.current=node)},[ref])})});return ReactComponent.displayName=displayName??elementClass.name,ReactComponent}({react:react,tagName:"twitch-video",elementClass:twitch_video_element_default,toAttributeName(propName){return"muted"===propName?"":"defaultMuted"===propName?"muted":defaultToAttributeName(propName)}})}}]);